nohup: ignoring input
[Paths]
  IN_DIR : /home/ubuntu/project/identification/output
  OUT_DIR: /home/ubuntu/project/predict/output
  LOG_DIR: /home/ubuntu/project/predict/output/logs
  VERIF  : /home/ubuntu/project/predict/output/verification
  A_MIJ  : /home/ubuntu/project/identification/output/a_mij__sentence_ctx.csv
  SENT   : /home/ubuntu/project/identification/output/sentences_scored_llm_ctx.csv
[JSON]  /home/ubuntu/project/predict/output/logs/selfcheck_inputs.json
[SELF-CHECK][inputs] {'a_mij_company_count': 192, 'sentences_company_count_total': 192, 'sentences_company_count_by_z': {1: 81, 2: 95, 3: 16}, 'companies_intersection': 192, 'companies_union': 192}
[WRITE] /home/ubuntu/project/predict/output/logs/a_mij_clean.csv rows=3528
[WRITE] /home/ubuntu/project/predict/output/a_mij_clean.csv rows=3528
[WRITE] /home/ubuntu/project/predict/output/logs/s_ijz_pool.csv rows=144
[WRITE] /home/ubuntu/project/predict/output/logs/s_m_ijz_agg.csv rows=34300
[WRITE] /home/ubuntu/project/predict/output/logs/labels_y.csv rows=192
[WRITE] /home/ubuntu/project/predict/output/logs/fijz_logratio.csv rows=144
[WRITE] /home/ubuntu/project/predict/output/fijz_logratio.csv rows=144
[WRITE] /home/ubuntu/project/predict/output/logs/features_X_base.csv rows=192
[WRITE] /home/ubuntu/project/predict/output/logs/features_prior.csv rows=192
[WRITE] /home/ubuntu/project/predict/output/logs/features_full.csv rows=192
[WRITE] /home/ubuntu/project/predict/output/features_X_base.csv rows=192
[JSON]  /home/ubuntu/project/predict/output/logs/split_meta.json
[SPLIT] train=154 companies, val=38 companies
[WRITE] /home/ubuntu/project/predict/output/verification/preds_train_lgbm.csv rows=154
[WRITE] /home/ubuntu/project/predict/output/verification/preds_val_lgbm.csv rows=38
[JSON]  /home/ubuntu/project/predict/output/verification/best_thresholds_lgbm.json
[WRITE] /home/ubuntu/project/predict/output/verification/confusion_matrix_val_lgbm.csv rows=3
[PLOT]  /home/ubuntu/project/predict/output/confusion_matrix_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/roc_ovr_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/pr_ovr_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z1_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z2_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z3_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/p_true_hist_val_lgbm.png
[PLOT]  /home/ubuntu/project/predict/output/p_true_violin_by_class_val_lgbm.png
[COPY] confusion_matrix_val_lgbm.png -> confusion_matrix_val.png
[COPY] roc_ovr_val_lgbm.png -> roc_ovr_val.png
[COPY] pr_ovr_val_lgbm.png -> pr_ovr_val.png
[COPY] p_true_hist_val_lgbm.png -> p_true_hist_val.png
[COPY] p_true_violin_by_class_val_lgbm.png -> p_true_violin_by_class_val.png
[JSON]  /home/ubuntu/project/predict/output/verification/metrics_lgbm.json
[WRITE] /home/ubuntu/project/predict/output/verification/preds_train_xgb.csv rows=154
[WRITE] /home/ubuntu/project/predict/output/verification/preds_val_xgb.csv rows=38
[JSON]  /home/ubuntu/project/predict/output/verification/best_thresholds_xgb.json
[WRITE] /home/ubuntu/project/predict/output/verification/confusion_matrix_val_xgb.csv rows=3
[PLOT]  /home/ubuntu/project/predict/output/confusion_matrix_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/roc_ovr_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/pr_ovr_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z1_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z2_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z3_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/p_true_hist_val_xgb.png
[PLOT]  /home/ubuntu/project/predict/output/p_true_violin_by_class_val_xgb.png
[JSON]  /home/ubuntu/project/predict/output/verification/metrics_xgb.json
[WRITE] /home/ubuntu/project/predict/output/verification/ensemble_tuning_trend.csv rows=12
[PLOT]  /home/ubuntu/project/predict/output/ensemble_tuning_trend.png
[JSON]  /home/ubuntu/project/predict/output/verification/metrics_ens.json
[WRITE] /home/ubuntu/project/predict/output/verification/preds_val_ens.csv rows=38
[WRITE] /home/ubuntu/project/predict/output/verification/confusion_matrix_val_ens.csv rows=3
[PLOT]  /home/ubuntu/project/predict/output/confusion_matrix_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/roc_ovr_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/pr_ovr_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z1_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z2_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/calibration_z3_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/p_true_hist_val_ens.png
[PLOT]  /home/ubuntu/project/predict/output/p_true_violin_by_class_val_ens.png
/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:1272: FutureWarning: 'multi_class' was deprecated in version 1.5 and will be removed in 1.8. From then on, it will always use 'multinomial'. Leave it to its default value to avoid this warning.
  warnings.warn(
Traceback (most recent call last):
  File "/home/ubuntu/project/predict/risk_predictor.py", line 1101, in <module>
    main()
  File "/home/ubuntu/project/predict/risk_predictor.py", line 1036, in main
    lr.fit(X_all_lin.values, y_hat - 1)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/base.py", line 1365, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py", line 1384, in fit
    fold_coefs_ = Parallel(n_jobs=self.n_jobs, verbose=self.verbose, prefer=prefer)(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/utils/parallel.py", line 82, in __call__
    return super().__call__(iterable_with_config_and_warning_filters)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/joblib/parallel.py", line 1986, in __call__
    return output if self.return_generator else list(output)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/joblib/parallel.py", line 1914, in _get_sequential_output
    res = func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/utils/parallel.py", line 147, in __call__
    return self.function(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py", line 311, in _logistic_regression_path
    class_weight_ = compute_class_weight(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 191, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/sklearn/utils/class_weight.py", line 98, in compute_class_weight
    raise ValueError(
ValueError: The classes, [0], are not in class_weight
